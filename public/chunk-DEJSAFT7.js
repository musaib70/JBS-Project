import{a as de}from"./chunk-HDSE5UMA.js";import{a as me}from"./chunk-HKX74XDH.js";import{a as _e}from"./chunk-KLEVXXGU.js";import{a as ue}from"./chunk-CRHXL4XG.js";import{b as X,c as g,d as Y,e as Z,f as $,h as ee,i as te,k as ie,l as oe,m as ne,n as re,o as ae,p as se,q as le,r as pe}from"./chunk-GC5MTBRV.js";import{a as ge}from"./chunk-Z2Z2GTJX.js";import{a as ce}from"./chunk-KLAMPWFI.js";import"./chunk-3X6K3PXT.js";import{Aa as r,Ba as a,Bb as R,Ca as w,Da as B,Db as T,Ea as x,G as P,Ga as S,Ia as b,J as W,Ja as y,L as k,Ra as c,S as v,Sa as F,T as M,Ta as V,Tc as J,Uc as Q,Va as u,Wa as _,Xa as h,Za as j,_a as L,cc as q,fa as N,ia as s,ja as f,mb as A,nb as O,qa as C,qb as z,ra as D,sa as d,sb as E,tc as G,vc as K,wc as U,yc as H}from"./chunk-7UEHT57M.js";import"./chunk-RGL3W33T.js";var I=class{constructor(){this._id=null,this.title="",this.category_id=null,this.description="",this.description_02="",this.description_03="",this.meta_description="",this.tags=[],this.image="",this.status=null}};var he=(()=>{let l=class l extends ge{constructor(o,i){super(i,o)}};l.\u0275fac=function(i){return new(i||l)(W(T),W(E))},l.\u0275prov=P({token:l,factory:l.\u0275fac,providedIn:"root"});let n=l;return n})();var Se=()=>({standalone:!0});function we(n,l){n&1&&w(0,"c-spinner",27)}function Be(n,l){if(n&1){let p=S();B(0),r(1,"button",25),b("click",function(){v(p);let i=y();return M(i.toggleModal())}),C(2,we,1,0,"c-spinner",26),c(3," Duplicate "),a(),x()}if(n&2){let p=y();s(),d("disabled",p.loading),s(),d("ngIf",p.loading)}}function xe(n,l){if(n&1&&(r(0,"option",28),c(1),a()),n&2){let p=l.$implicit;d("value",p._id),s(),F(p.name)}}function Fe(n,l){if(n&1){let p=S();r(0,"div",29)(1,"span"),c(2),a(),r(3,"button",30),b("click",function(){let i=v(p).index,e=y();return M(e.removeAttribute(i))}),c(4," \xD7 "),a()()}if(n&2){let p=l.$implicit;s(2),F(p)}}function Ee(n,l){if(n&1&&(r(0,"option",28),c(1),a()),n&2){let p=l.$implicit;d("value",p.id),s(),F(p.status)}}function Te(n,l){n&1&&w(0,"c-spinner",27)}function Ie(n,l){if(n&1){let p=S();B(0),r(1,"button",25),b("click",function(){v(p);let i=y();return M(i.submitPost())}),C(2,Te,1,0,"c-spinner",26),c(3," Publish Post "),a(),x()}if(n&2){let p=y();s(),d("disabled",p.loading),s(),d("ngIf",p.loading)}}function We(n,l){n&1&&w(0,"c-spinner",27)}function Pe(n,l){if(n&1){let p=S();B(0),r(1,"button",25),b("click",function(){v(p);let i=y();return M(i.updatePost())}),C(2,We,1,0,"c-spinner",26),c(3," Update Post "),a(),x()}if(n&2){let p=y();s(),d("disabled",p.loading),s(),d("ngIf",p.loading)}}var tt=(()=>{let l=class l{constructor(o,i,e,m,t,Ce,fe){this.httpClient=o,this.route=i,this.router=e,this.postCategoryService=m,this.postService=t,this.formBuilder=Ce,this.toastr=fe,this.is_update=!1,this.page_title="Add",this.base64File=null,this.categories=[],this.attribute="",this.attributes=[],this.visibleModal=!1,this.currentPost="",this.loading=!1,this.validation=new ue,this.statuses=[{id:1,status:"Active"},{id:0,status:"Inactive"}],this.post=new I,this.init={plugins:"anchor autolink charmap codesample emoticons image link lists media searchreplace table visualblocks wordcount",toolbar:"undo redo | blocks fontfamily fontsize | bold italic underline strikethrough | link image media table | align lineheight | numlist bullist indent outdent | emoticons charmap | removeformat"}}ngOnInit(){let o=this.route.snapshot.paramMap.get("id");o&&(this.postService.getExisting("post/edit/",o).subscribe(i=>{this.currentPost=JSON.stringify(i),this.post=i,this.attributes=this.post.tags,console.log("Response",i)}),this.page_title="Update",this.is_update=!0),this.initializeForm(),this.fetchPostCategories()}initializeForm(){this.form=$,this.form=this.formBuilder.group({title:[this.post.title,g.compose([g.required])],category_id:[this.post.category_id,g.compose([g.required])],description:[this.post.description,g.compose([g.required])],meta_description:[this.post.meta_description,g.compose([g.required])],image:[this.post.image,g.compose([g.required])],status:[this.post.status,g.compose([g.required])]})}addAttribute(){this.attributes.push(this.attribute),this.attribute=""}removeAttribute(o){this.attributes=this.attributes.filter((i,e)=>e!=o)}toggleModal(o=null){this.visibleModal=!this.visibleModal}closeModal(){this.visibleModal=!1}duplicateRecord(){try{this.loading=!0,this.postService.insert({id:this.post._id},"post/duplicate").subscribe(o=>{console.log(o),this.toastr.success("Post has been duplicated"),this.router.navigate(["/post"])})}catch(o){this.toastr.error("Error occured in duplication"),console.log(o)}}onFileSelected(o){let i=o.target.files?.[0];i&&this.convertToBase64(i)}convertToBase64(o){let i=new FileReader;i.onload=()=>{this.base64File=i.result,this.post.image=this.base64File},i.onerror=e=>{console.error("Error reading file:",e)},i.readAsDataURL(o)}fetchPostCategories(){this.postCategoryService.list("post_category/list").subscribe(o=>{this.categories=o.body})}submitPost(){if(this.loading=!0,!this.validation.validateForm(this.form)){this.loading=!1,this.toastr.error("Some fields are missing!");return}this.post.tags=this.attributes;try{this.postService.insert(this.post,"post/create").subscribe(o=>{o.status?(this.router.navigate(["/post"]),this.toastr.success("New post has been added")):o.status==!1&&(this.loading=!1,this.toastr.error(`${o.message}`))})}catch(o){console.log(o)}}updatePost(){this.loading=!0,this.post.tags=this.attributes;let o=JSON.parse(this.currentPost);this.post.image==o.image&&delete this.post.image;try{this.postService.update(`post/update?id=${this.post._id}`,this.post).subscribe(i=>{i.status?(this.router.navigate(["/post"]),this.toastr.success("Post has been updated")):i.status==!1&&(this.loading=!1,this.toastr.error(`${i.message}`))})}catch(i){console.log(i)}}};l.\u0275fac=function(i){return new(i||l)(f(E),f(R),f(T),f(_e),f(he),f(se),f(ce))},l.\u0275cmp=k({type:l,selectors:[["app-create-blog"]],standalone:!0,features:[j],decls:58,vars:25,consts:[[1,"bg-light","dark:bg-transparent","d-flex","flex-row","align-items-center"],[1,"mb-5"],[1,"row"],[1,"col"],[1,"col","text-end"],[4,"ngIf"],["title","Duplicate","message","Are you sure you want to duplicate this post?",3,"toggleModal","trigger","closeModal","visible","objectId"],["cForm","",3,"formGroup"],[1,"mb-3"],["cLabel","","for","exampleFormControlInput1"],["cFormControl","","placeholder","Post Title","type","text","formControlName","title",3,"ngModelChange","ngModel"],["formControlName","meta_description","cFormControl","","id","exampleFormControlTextarea1","rows","6",3,"ngModelChange","ngModel"],["formControlName","category_id","aria-label","Large select example","cSelect","","sizing","md",1,"mb-3",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],[1,"d-flex","col-6",2,"gap","10px","align-items","center"],["cFormControl","","placeholder","","type","text",3,"ngModelChange","ngModelOptions","ngModel"],["cButton","","color","primary",3,"click"],[1,"d-flex","flex-wrap","gap-2"],["class","d-flex align-items-center border rounded px-3 py-2 bg-light","style","gap: 0.5rem;",4,"ngFor","ngForOf"],["cLabel","","for","exampleFormControlTextarea1"],["formControlName","description","apiKey","tn289rmrnw2dnyq1h2wxdt9s263v57gxc3j3ctpi17idt5hv",3,"ngModelChange","ngModel","init"],["formControlName","description_02","apiKey","tn289rmrnw2dnyq1h2wxdt9s263v57gxc3j3ctpi17idt5hv",3,"ngModelChange","ngModel","init"],["formControlName","description_03","apiKey","tn289rmrnw2dnyq1h2wxdt9s263v57gxc3j3ctpi17idt5hv",3,"ngModelChange","ngModel","init"],["formControlName","image","cFormControl","","id","inputGroupFile01","type","file",3,"ngModelChange","change","ngModel"],["formControlName","status","aria-label","Large select example","cSelect","","sizing","md",1,"mb-3",3,"ngModelChange","ngModel"],["cButton","","color","primary",3,"click","disabled"],["color","white","size","sm","role","status","aria-hidden","true",4,"ngIf"],["color","white","size","sm","role","status","aria-hidden","true"],[3,"value"],[1,"d-flex","align-items-center","border","rounded","px-3","py-2","bg-light",2,"gap","0.5rem"],["type","button",1,"btn","btn-close","p-0","text-danger",2,"font-size","1rem","line-height","1",3,"click"]],template:function(i,e){i&1&&(r(0,"div",0)(1,"c-container")(2,"div",1)(3,"div",2)(4,"div",3)(5,"h2"),c(6),a()(),r(7,"div",4),C(8,Be,4,2,"ng-container",5),a()()(),r(9,"app-modal",6),b("toggleModal",function(){return e.toggleModal()})("trigger",function(){return e.duplicateRecord()})("closeModal",function(){return e.closeModal()}),a(),r(10,"form",7)(11,"div",8)(12,"label",9),c(13,"Title"),a(),r(14,"input",10),h("ngModelChange",function(t){return _(e.post.title,t)||(e.post.title=t),t}),a()(),r(15,"div",8)(16,"label",9),c(17,"Meta Description"),a(),r(18,"textarea",11),h("ngModelChange",function(t){return _(e.post.meta_description,t)||(e.post.meta_description=t),t}),a()(),r(19,"div",8)(20,"label",9),c(21,"Choose Category"),a(),r(22,"select",12),h("ngModelChange",function(t){return _(e.post.category_id,t)||(e.post.category_id=t),t}),C(23,xe,2,2,"option",13),a()(),r(24,"div",8)(25,"label",9),c(26,"Select Attributes"),a(),r(27,"div",14)(28,"input",15),h("ngModelChange",function(t){return _(e.attribute,t)||(e.attribute=t),t}),a(),r(29,"button",16),b("click",function(){return e.addAttribute()}),c(30,"Add"),a()()(),r(31,"div",8)(32,"div",17),C(33,Fe,5,1,"div",18),a()(),r(34,"div",8)(35,"label",19),c(36,"Description"),a(),r(37,"editor",20),h("ngModelChange",function(t){return _(e.post.description,t)||(e.post.description=t),t}),a()(),r(38,"div",8)(39,"label",19),c(40,"Description 02"),a(),r(41,"editor",21),h("ngModelChange",function(t){return _(e.post.description_02,t)||(e.post.description_02=t),t}),a()(),r(42,"div",8)(43,"label",19),c(44,"Description 03"),a(),r(45,"editor",22),h("ngModelChange",function(t){return _(e.post.description_03,t)||(e.post.description_03=t),t}),a()(),r(46,"div",8)(47,"label",19),c(48,"Featured Image"),a(),r(49,"input",23),h("ngModelChange",function(t){return _(e.post.image,t)||(e.post.image=t),t}),b("change",function(t){return e.onFileSelected(t)}),a()(),r(50,"div",8)(51,"label",9),c(52,"Status"),a(),r(53,"select",24),h("ngModelChange",function(t){return _(e.post.status,t)||(e.post.status=t),t}),C(54,Ee,2,2,"option",13),a()(),r(55,"div",1),C(56,Ie,4,2,"ng-container",5)(57,Pe,4,2,"ng-container",5),a()()()()),i&2&&(s(6),V("",e.page_title," Post"),s(2),d("ngIf",e.is_update),s(),d("visible",e.visibleModal)("objectId",e.post._id),s(),d("formGroup",e.form),s(4),u("ngModel",e.post.title),s(4),u("ngModel",e.post.meta_description),D("style","resize: none;",N),s(4),u("ngModel",e.post.category_id),s(),d("ngForOf",e.categories),s(5),d("ngModelOptions",L(24,Se)),u("ngModel",e.attribute),s(5),d("ngForOf",e.attributes),s(4),u("ngModel",e.post.description),d("init",e.init),s(4),u("ngModel",e.post.description_02),d("init",e.init),s(4),u("ngModel",e.post.description_03),d("init",e.init),s(4),u("ngModel",e.post.image),s(4),u("ngModel",e.post.status),s(),d("ngForOf",e.statuses),s(2),d("ngIf",!e.is_update),s(),d("ngIf",e.is_update))},dependencies:[Q,J,me,pe,te,re,ae,X,ne,Y,Z,ie,oe,le,ee,z,A,O,de,H,G,U,q,K],encapsulation:2});let n=l;return n})();export{tt as CreateBlogComponent};
